knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
install.package("sjPlot")
install.packages("sjPlot")
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(MASS)
library(BMA)
install.packages("BMA")
install.packages("BMROCR")
install.packages("ROCR")
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(MASS)
library(BMA)
library(ROCR)
film <- read.csv("dataset5.csv")
film <- film %>%
mutate(rating.large7 = cut(rating, breaks = c(0,7,Inf), labels=c(0,1)))
model <-  glm(rating.large7 ~ year + length + budget + votes , family = binomial(link = "cloglog"), data = film)
logit.step <- step(model,direction='both')
summary(logit.step)
model <-  glm(rating.large7 ~ year + length + budget + votes , family = binomial(link = "cloglog"), data = film)
logit.step <- step(model,direction='both')
summary(logit.step)
logit.step
step(model,direction='both')
film
model <-  glm(rating.large7 ~ year + length + budget + votes , family = binomial(link = "cloglog"), data = film)
logit.step <- step(model,direction='both')
summary(logit.step)
model1 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "logit"), data = film)
summ(model1)
model1 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "logit"), data = film)
summ(model1)
model2 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "probit"), data = film)
summ(model2)
model3 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "cloglog"), data = film)
summ(model3)
BIC.model <- bic.glm(x = data.frame(film[,2:6]), y=film$rating.large7,
f = rating.large7 ~ year + length + budget + votes + genre,
strict = FALSE, glm.family="binomial", factor.type=TRUE)
film_p <- data.frame(film = film,
logit = fitted(model1),
probit = fitted(model2),
cloglog = fitted(model3))
fitted(model1)
film_p <- data.frame(film = film,
logit = fitted(model1),
probit = fitted(model2),
cloglog = fitted(model3))
film
logit
film
nrow(fitted(model1))
length(fitted(model1))
nrow(film)
length(fitted(model1))
fitted(model1)
length(fitted(model1))
nrow(film)
length(fitted(model1))
film_p <- data.frame(film = film,
logit = fitted(model1),
probit = fitted(model2),
cloglog = fitted(model3))
length(fitted(model1))
nrow(film)
nrow(na.omit(film))
length(fitted(model1))
nrow(na.omit(film))
length(fitted(model1))
nrow(na.omit(film))
film <- film %>%
mutate(rating.large7 = cut(rating, breaks = c(0,7,Inf), labels=c(0,1))) %>%
na.omit()
model <-  glm(rating.large7 ~ year + length + budget + votes , family = binomial(link = "cloglog"), data = film)
logit.step <- step(model,direction='both')
summary(logit.step)
model1 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "logit"), data = film)
summ(model1)
model2 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "probit"), data = film)
summ(model2)
model3 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "cloglog"), data = film)
summ(model3)
BIC.model <- bic.glm(x = data.frame(film[,2:6]), y=film$rating.large7,
f = rating.large7 ~ year + length + budget + votes + genre,
strict = FALSE, glm.family="binomial", factor.type=TRUE)
film_p <- data.frame(film = film,
logit = fitted(model1),
probit = fitted(model2),
cloglog = fitted(model3))
ggplot(film_p, aes(x = film$rating.large7, y = film$votes)) +
geom_point() + xlab("Votes") + ylab("Rating") +
geom_line(aes(x = film$rating, y = logit, colour = "Logit")) +
geom_line(aes(x = film$rating, y = probit, colour = "Probit")) +
geom_line(aes(x = film$rating, y = cloglog, colour = "C log-log")) +
guides(colour = guide_legend("Method"))
film_p <- data.frame(film = film,
logit = fitted(model1),
probit = fitted(model2),
cloglog = fitted(model3))
ggplot(film_p, aes(y = film$rating.large7, x = film$votes)) +
geom_point() + xlab("Votes") + ylab("Rating") +
geom_line(aes(x = film$rating, y = logit, colour = "Logit")) +
geom_line(aes(x = film$rating, y = probit, colour = "Probit")) +
geom_line(aes(x = film$rating, y = cloglog, colour = "C log-log")) +
guides(colour = guide_legend("Method"))
film_p <- data.frame(film = film,
logit = fitted(model1),
probit = fitted(model2),
cloglog = fitted(model3))
ggplot(film_p, aes(y = film$rating.large7, x = film$year)) +
geom_point() + xlab("Votes") + ylab("Rating") +
geom_line(aes(x = film$rating, y = logit, colour = "Logit")) +
geom_line(aes(x = film$rating, y = probit, colour = "Probit")) +
geom_line(aes(x = film$rating, y = cloglog, colour = "C log-log")) +
guides(colour = guide_legend("Method"))
model1 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "logit"), data = film)
summary(model1)
model1 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "logit"), data = film)
summary(model1)
model2 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "probit"), data = film)
summary(model2)
model3 <- glm(rating.large7 ~ length + budget + votes + genre, family = binomial(link = "cloglog"), data = film)
summary(model3)
